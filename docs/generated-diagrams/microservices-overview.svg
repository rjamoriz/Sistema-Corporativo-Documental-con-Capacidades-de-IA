<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="720" viewBox="0 0 1200 720" role="img" aria-labelledby="title desc">
  <title id="title">Arquitectura de Microservicios - Vista Ejecutiva</title>
  <desc id="desc">Diagrama estático para README: cliente web, gateway/API, microservicios clave, y almacenes de datos.</desc>
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#0b1220"/>
      <stop offset="100%" stop-color="#0e172a"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.35"/>
    </filter>
    <style>
      .title { fill: #e5e7eb; font: 700 28px 'Segoe UI', Roboto, Arial, sans-serif; }
      .subtitle { fill: #94a3b8; font: 500 16px 'Segoe UI', Roboto, Arial, sans-serif; }
      .group-title { fill: #cbd5e1; font: 600 15px 'Segoe UI', Roboto, Arial, sans-serif; }
      .box { fill: #111827; stroke: #334155; stroke-width: 1.5; rx: 10; filter: url(#shadow); }
      .box-accent { fill: #0f172a; stroke: #3b82f6; stroke-width: 1.5; rx: 10; filter: url(#shadow); }
      .label { fill: #e5e7eb; font: 600 15px 'Segoe UI', Roboto, Arial, sans-serif; }
      .small { fill: #94a3b8; font: 500 12px 'Segoe UI', Roboto, Arial, sans-serif; }
      .arrow { stroke: #64748b; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-strong { stroke: #60a5fa; stroke-width: 2.5; marker-end: url(#arrowhead-strong); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#64748b"/>
    </marker>
    <marker id="arrowhead-strong" markerWidth="12" markerHeight="12" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L9,3.5 L0,7 Z" fill="#60a5fa"/>
    </marker>
  </defs>
  <rect x="0" y="0" width="1200" height="720" fill="url(#bg)"/>

  <!-- Header -->
  <text class="title" x="40" y="56">Sistema Documental con IA — Arquitectura de Microservicios</text>
  <text class="subtitle" x="40" y="84">Front (React) → API Gateway (FastAPI) → Servicios (OCR, NLP/Embeddings, RAG/QA, Búsqueda, Compliance) → Datos (PostgreSQL, Qdrant, Redis, MinIO)</text>

  <!-- Client -->
  <rect class="box" x="40" y="120" width="260" height="80"/>
  <text class="group-title" x="50" y="145">Cliente</text>
  <text class="label" x="50" y="170">React SPA</text>
  <text class="small" x="50" y="190">TypeScript · Vite</text>

  <!-- API Gateway -->
  <rect class="box-accent" x="340" y="120" width="260" height="80"/>
  <text class="group-title" x="350" y="145">Entrada</text>
  <text class="label" x="350" y="170">API Gateway (FastAPI)</text>
  <text class="small" x="350" y="190">REST/GraphQL · Auth JWT</text>

  <!-- Services group background -->
  <rect x="40" y="240" width="1120" height="300" rx="12" fill="#0b1220" stroke="#1f2937"/>
  <text class="group-title" x="50" y="265">Servicios de Dominio</text>

  <!-- Row 1 services -->
  <rect class="box" x="60" y="280" width="220" height="90"/>
  <text class="label" x="70" y="305">Ingestion Service</text>
  <text class="small" x="70" y="330">Carga, validación, normalización</text>

  <rect class="box" x="300" y="280" width="220" height="90"/>
  <text class="label" x="310" y="305">OCR Service</text>
  <text class="small" x="310" y="330">PDF/Imagen → Texto</text>

  <rect class="box" x="540" y="280" width="260" height="90"/>
  <text class="label" x="550" y="305">NLP & Embeddings</text>
  <text class="small" x="550" y="330">SpaCy · SBERT · OpenAI</text>

  <rect class="box" x="820" y="280" width="320" height="90"/>
  <text class="label" x="830" y="305">RAG / QA Service</text>
  <text class="small" x="830" y="330">Recuperación + Generación con citas</text>

  <!-- Row 2 services -->
  <rect class="box" x="60" y="390" width="260" height="90"/>
  <text class="label" x="70" y="415">Search API</text>
  <text class="small" x="70" y="440">Búsqueda híbrida (BM25 + vectores)</text>

  <rect class="box" x="340" y="390" width="260" height="90"/>
  <text class="label" x="350" y="415">Compliance Service</text>
  <text class="small" x="350" y="440">GDPR · EU AI Act · OFAC · EUR‑Lex</text>

  <rect class="box" x="620" y="390" width="260" height="90"/>
  <text class="label" x="630" y="415">Workers / Orchestrator</text>
  <text class="small" x="630" y="440">Colas y pipelines con Celery</text>

  <rect class="box" x="900" y="390" width="240" height="90"/>
  <text class="label" x="910" y="415">Notification Service</text>
  <text class="small" x="910" y="440">Email · Webhooks · Eventos</text>

  <!-- Data layer -->
  <rect x="40" y="560" width="1120" height="120" rx="12" fill="#0b1220" stroke="#1f2937"/>
  <text class="group-title" x="50" y="585">Datos y Almacenamiento</text>

  <rect class="box" x="60" y="600" width="240" height="60"/>
  <text class="label" x="70" y="625">PostgreSQL</text>
  <text class="small" x="70" y="645">Metadatos · Auditoría</text>

  <rect class="box" x="340" y="600" width="240" height="60"/>
  <text class="label" x="350" y="625">Qdrant</text>
  <text class="small" x="350" y="645">Embeddings semánticos</text>

  <rect class="box" x="620" y="600" width="240" height="60"/>
  <text class="label" x="630" y="625">Redis</text>
  <text class="small" x="630" y="645">Cache · Broker</text>

  <rect class="box" x="900" y="600" width="240" height="60"/>
  <text class="label" x="910" y="625">MinIO (S3)</text>
  <text class="small" x="910" y="645">Almacenamiento de archivos</text>

  <!-- External systems -->
  <rect class="box" x="940" y="120" width="220" height="80"/>
  <text class="group-title" x="950" y="145">Externo</text>
  <text class="label" x="950" y="170">OpenAI · OFAC · EUR‑Lex · Phoenix</text>

  <!-- Flows -->
  <line class="arrow-strong" x1="300" y1="160" x2="340" y2="160"/>
  <line class="arrow-strong" x1="600" y1="200" x2="600" y2="280"/>

  <line class="arrow" x1="470" y1="200" x2="470" y2="280"/>
  <line class="arrow" x1="190" y1="200" x2="190" y2="280"/>

  <line class="arrow" x1="170" y1="370" x2="170" y2="600"/>
  <line class="arrow" x1="430" y1="370" x2="430" y2="600"/>
  <line class="arrow" x1="710" y1="480" x2="710" y2="600"/>
  <line class="arrow" x1="1020" y1="480" x2="1020" y2="600"/>

  <line class="arrow" x1="880" y1="200" x2="960" y2="200"/>
  <line class="arrow" x1="1060" y1="200" x2="1060" y2="280"/>

  <!-- Legend -->
  <rect x="40" y="20" width="320" height="60" rx="8" fill="#0b1220" stroke="#1f2937"/>
  <circle cx="60" cy="50" r="6" fill="#60a5fa"/>
  <text class="small" x="75" y="54">Flujos principales (trazas reforzadas)</text>
  <circle cx="240" cy="50" r="6" fill="#64748b"/>
  <text class="small" x="255" y="54">Flujos secundarios</text>
</svg>
